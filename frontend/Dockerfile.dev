# 使用轻量级的 Node 镜像
FROM docker.1ms.run/node:18-alpine

# 设置工作目录
WORKDIR /app

# 设置环境变量，解决某些网络环境下的安装问题
ENV NPM_CONFIG_REGISTRY=https://registry.npmmirror.com

# 暴露 Vite 默认端口
EXPOSE 5173

# 启动命令：
# 1. 安装依赖 (如果 node_modules 不存在)
# 2. 启动开发服务器，并绑定到 0.0.0.0 以便外部访问
CMD sh -c "if [ ! -d node_modules ]; then npm install; fi && npm run dev -- --host 0.0.0.0"
